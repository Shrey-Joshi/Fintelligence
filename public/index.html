<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <title>Fintelligence Investor Demo</title>
  <link rel="stylesheet" href="/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1>Fintelligence</h1>
      <p class="tagline">Investor Demo: Financial Intelligence Platform</p>
    </header>
    
    <main class="dashboard">
      <section class="inputs">
        <div class="card">
          <h3>Banking (Checking/Savings)</h3>
          <div class="input-group">
            <label>Checking Balance ($)</label>
            <input type="number" id="checking" value="5420.50">
          </div>
          <div class="input-group">
            <label>Savings Balance ($)</label>
            <input type="number" id="savings" value="12500.00">
          </div>
        </div>

        <div class="card">
          <h3>Portfolio (Brokerage)</h3>
          <div class="input-group">
            <label>Stock Portfolio Value ($)</label>
            <input type="number" id="portfolio" value="45200.00">
          </div>
          <div class="input-group">
            <label>Risk Tolerance</label>
            <select id="risk">
              <option value="conservative">Conservative</option>
              <option value="moderate" selected>Moderate</option>
              <option value="aggressive">Aggressive</option>
            </select>
          </div>
        </div>

        <div class="card">
          <h3>Latest News (RSS Feed Simulation)</h3>
          <div class="input-group">
            <label>News Items (one per line)</label>
            <textarea id="news" rows="4">Federal Reserve signals rate cut in Q3
Tech stocks rally on AI breakthrough
Global trade tensions ease slightly
Inflation data shows cooling trend</textarea>
          </div>
        </div>
      </section>

      <section class="actions">
        <button id="analyze-btn" class="primary-btn">Generate AI Financial Advice</button>
      </section>

      <section class="results">
        <div id="loading" class="hidden">Analyzing data with AI...</div>
        <div id="advice-container" class="card advice-card hidden">
          <h3>AI Investment Thesis</h3>
          <div id="advice-content"></div>
        </div>
      </section>
    </main>
  </div>

  <script>
    document.getElementById('analyze-btn').addEventListener('click', async () => {
      const loading = document.getElementById('loading');
      const adviceContainer = document.getElementById('advice-container');
      const adviceContent = document.getElementById('advice-content');
      
      loading.classList.remove('hidden');
      adviceContainer.classList.add('hidden');
      
      const data = {
        finances: {
          checking: parseFloat(document.getElementById('checking').value),
          savings: parseFloat(document.getElementById('savings').value)
        },
        portfolio: {
          value: parseFloat(document.getElementById('portfolio').value),
          risk: document.getElementById('risk').value
        },
        news: document.getElementById('news').value.split('\n').filter(l => l.trim())
      };

      try {
        const response = await fetch('/api/analyze', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        adviceContent.innerHTML = marked.parse(result.advice);
        adviceContainer.classList.remove('hidden');
      } catch (error) {
        alert('Error generating advice. Please check console.');
        console.error(error);
      } finally {
        loading.classList.add('hidden');
      }
    });
  </script>
</body>
</html>
